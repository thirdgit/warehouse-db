# База данных склада стройматериалов

База данных предназначена для следующих задач:
- Контролировать содержимое склада строительных материалов.
- Ведение детального учёта поставок, который включает в себя дату поставки, поступившие материалы, их количество и стоимость от поставщика.
- Ведение детального учёта заказов, который включает в себя дату заказа, идентификатор заказчика, проданные материалы, их количество и стоимость на момент продажи.

## Структура базы данных

В этой базе отражены 4 сущности и 2 промежуточные таблицы.

### Сущности и их аттрибуты:
1. **Стройматериалы** - материал, остаток, цена
3. **Заказы** - клиент, материал, кол-во материала, цена материала на момент продажи
4. **Клиенты** - имя, телефон, адрес
2. **Поставки** - материал, кол-во материала, цена материала на момент поставки

### Промежуточные таблицы:
Позволяют создавать несколько позиций в заказе/поставке без дублирования данных.
1. **Заказы-Стройматериалы** - отвечает за содержимое заказов
2. **Поставки-Стройматериалы** - отвечает за содержимое поставок

![](https://github.com/thirdgit/warehouse-db/blob/main/warehouse_db.png?raw=true)

## Системные требования

1. **Операционная система:** Windows, macOS, Linux и пр.
2. **Процессор:** от 1 ГГц
3. **Оперативная память:** от 1 ГБ
4. **Дисковое пространство:** от 1 ГБ (свободного)

## Установка

1. Установить MySQL-сервер
2. Загрузить файлы из репозитория: `warehouse_db_struct.sql` и `warehouse_db_data.sql`
3. Для создания структуры - выполнить код из файла `warehouse_db_struct.sql`
4. Для добавления тестовых данных - выполнить код из файла `warehouse_db_data.sql` (не обязательно)

## Примеры запросов к базе данных:
1. Получение всех клиентов склада
```sql
select * from `clients`;
```

2. Получение всех материалов на складе
```sql
select * from `materials`;
```

3. Получение закончившихся материалов на складе
```sql
select * from `materials` where `count`=0;
```

4. Получение всех заказов с отображением имени заказчика
```sql
select
    `o`.`order_id`,
    `o`.`order_time`,
    `o`.`order_amount`,
    `o`.`client_id`,
    `c`.`client_name`
from `orders` as `o`
inner join `clients` as `c`
    on `c`.`client_id` = `o`.`client_id`
order by `o`.`order_time` desc;
```

5. Получение деталей заказа по его идентификатору
```sql
select
    `m`.`material_title`,
    `ohm`.`count`,
    `ohm`.`price`
from `orders_has_materials` as `ohm`
inner join `materials` as `m`
    on `ohm`.`material_id` = `m`.`material_id`
where `ohm`.`order_id`=?;]
```

6. Создание нового заказа
```sql
call `order_create`(1, @order_id);        # Создание заказа для пользователя под номером 1
call `order_add_item`(@order_id, 1, 25);  # Добавление материала под номером 1 в количестве 25 шт.
call `order_add_item`(@order_id, 2, 100); # Добавление материала под номером 2 в количестве 100 шт.
call `order_add_item`(@order_id, 3, 1);   # Добавление материала под номером 3 в количестве 1 шт.
```
